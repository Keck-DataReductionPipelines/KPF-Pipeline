pipeline {
  agent any
  stages {
    stage('Build & Test') {
      when {
        anyOf {
          // 1a) A PR from develop ‚Üí master
          allOf {
            changeRequest()
            branch 'develop'
            expression { env.CHANGE_TARGET == 'master' }
          }
          // 1b) Any direct commit to master
          branch 'master'
        }
      }
      steps {
        echo "üèóÔ∏è  Running KPF CI on ${env.BRANCH_NAME} (PR #${env.CHANGE_ID} ‚Üí ${env.CHANGE_TARGET})"
        // ‚Ä¶your build steps here‚Ä¶
      }
    }
  }
}